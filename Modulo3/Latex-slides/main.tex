\documentclass[aspectratio=169]{beamer}

% ============================================
% PACOTES ADICIONAIS
% ============================================
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{amsmath}
\usepackage{mathtools}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{cite}
\usepackage{url}
\usepackage{hyperref}
\usepackage{ifthen}
\usepackage{xstring}
\usepackage{bm}
\usepackage{array}
\usepackage{cancel}
\usepackage{tikz}
\usetikzlibrary{shapes.geometric, arrows.meta, positioning, calc, fit}
\usepackage{listings}
\lstset{
    language=Python,
    basicstyle=\ttfamily\scriptsize,
    keywordstyle=\color{unbprimary}\bfseries,
    stringstyle=\color{unbsecondary!80!black},
    commentstyle=\color{gray}\itshape,
    numbers=left,
    numberstyle=\tiny\color{gray},
    numbersep=5pt,
    frame=single,
    rulecolor=\color{gray!40},
    breaklines=true,
    showstringspaces=false,
    tabsize=4,
    backgroundcolor=\color{gray!8},
    xleftmargin=0.4cm,
    xrightmargin=0.1cm,
}

% ============================================
% VARIÁVEIS DE CONFIGURAÇÃO
% ============================================

% --- Informações do Autor ---
\newcommand{\autorNome}{Prof. Daniel Costa Araújo}
\newcommand{\autorEmail}{daniel.araujo@unb.br}

% --- Título e Subtítulo ---
\newcommand{\tituloApresentacao}{Conversão A/D e Transmissão Digital}
\newcommand{\subtituloApresentacao}{Capítulos 6--7 (Proakis) e Capítulo 5 (Lathi)}

% --- Idioma ---
\newcommand{\idioma}{pt}

% --- Instituição (Português) ---
\newcommand{\universidadePT}{Universidade de Brasília}
\newcommand{\departamentoPT}{Faculdade de Ciências e Tecnologia em Engenharias}
\newcommand{\laboratorioPT}{Laboratório de Telecomunicações}

% --- Instituição (Inglês) ---
\newcommand{\universidadeEN}{University of Brasília}
\newcommand{\departamentoEN}{Faculty of Sciences and Technology in Engineering}
\newcommand{\laboratorioEN}{Telecommunications Laboratory}

% --- Data ---
\newcommand{\dataApresentacao}{\today}

% ============================================
% CONFIGURAÇÃO AUTOMÁTICA BASEADA NO IDIOMA
% ============================================
\newcommand{\institutoFinal}{%
    \ifthenelse{\equal{\idioma}{pt}}{%
        \universidadePT \\ \laboratorioPT%
    }{%
        \universidadeEN \\ \laboratorioEN%
    }%
}
\newcommand{\universidadeFinal}{%
    \ifthenelse{\equal{\idioma}{pt}}{\universidadePT}{\universidadeEN}%
}
\newcommand{\laboratorioFinal}{%
    \ifthenelse{\equal{\idioma}{pt}}{\laboratorioPT}{\laboratorioEN}%
}

% ============================================
% CARREGAR TEMPLATE UnB/LabTelecom
% ============================================
\input{../../template/beamertheme-unb.sty}

% ============================================
% APLICAR CONFIGURAÇÕES AO DOCUMENTO
% ============================================
\title{\tituloApresentacao}
\subtitle{\subtituloApresentacao}
\author{\autorNome}
\institute{\institutoFinal}
\date{\dataApresentacao}

% ============================================
% COMANDOS ÚTEIS
% ============================================
\newcommand{\FT}[1]{\mathcal{F}\{#1\}}
\newcommand{\IFT}[1]{\mathcal{F}^{-1}\{#1\}}
\newcommand{\conv}{\ast}
\newcommand{\sinc}{\mathrm{sinc}}
\newcommand{\rect}{\mathrm{rect}}
\newcommand{\SQNR}{\mathrm{SQNR}}
\newcommand{\SNR}{\mathrm{SNR}}
\DeclareMathOperator{\Real}{Re}
\DeclareMathOperator{\Imag}{Im}

% ============================================
% MACRO: DIAGRAMA DE BLOCO DA CADEIA COMPLETA
% Uso: \drawpipeline{lista,de,blocos,destacados}
% Blocos disponíveis: aa, sampler, quant, encoder,
%                     linecoder, pulseshaper, channel, detector
% ============================================
\newcommand{\drawpipeline}[1]{%
  % --- Pré-computar estilos ANTES de entrar no tikzpicture ---
  % (evita conflito entre xstring e pgfkeys)
  \IfSubStr{#1}{aa}{\def\blkAA{hblk}}{\def\blkAA{blk}}%
  \IfSubStr{#1}{sampler}{\def\blkSAMP{hblk}}{\def\blkSAMP{blk}}%
  \IfSubStr{#1}{quant}{\def\blkQ{hblk}}{\def\blkQ{blk}}%
  \IfSubStr{#1}{encoder}{\def\blkENC{hblk}}{\def\blkENC{blk}}%
  \IfSubStr{#1}{linecoder}{\def\blkLC{hblk}}{\def\blkLC{blk}}%
  \IfSubStr{#1}{pulseshaper}{\def\blkPS{hblk}}{\def\blkPS{blk}}%
  \IfSubStr{#1}{channel}{\def\blkCH{hblk}}{\def\blkCH{blk}}%
  \IfSubStr{#1}{detector}{\def\blkDET{hblk}}{\def\blkDET{blk}}%
  \begin{center}
  \begin{tikzpicture}[
    blk/.style={draw, fill=gray!10, rectangle, rounded corners=3pt,
                minimum width=1.80cm, minimum height=0.68cm,
                text centered, font=\scriptsize, draw=gray!50, inner sep=3pt},
    hblk/.style={draw, fill=unbprimary!80, rectangle, rounded corners=3pt,
                 minimum width=1.80cm, minimum height=0.68cm,
                 text centered, font=\scriptsize\bfseries,
                 text=white, draw=unbprimary, inner sep=3pt},
    arw/.style={->, >=stealth, semithick, color=gray!60},
    grplbl/.style={font=\tiny\itshape, color=unbprimary!70}
  ]
    % ---------- ROW 1: ADC (y=0) ----------
    \node[\blkAA]   (aa)   at (0,   0)   {\strut Filt.~AA};
    \node[\blkSAMP] (samp) at (2.2, 0)   {\strut Amostrador};
    \node[\blkQ]    (q)    at (4.4, 0)   {\strut Quantizador};
    \node[\blkENC]  (enc)  at (6.6, 0)   {\strut Cod.~PCM};

    % ---------- ROW 2: Digital TX (y=-1.4) ----------
    \node[\blkLC]  (lc)  at (0,   -1.4) {\strut Cod.~Linha};
    \node[\blkPS]  (ps)  at (2.2, -1.4) {\strut F.~Pulso};
    \node[\blkCH]  (ch)  at (4.4, -1.4) {\strut Canal};
    \node[\blkDET] (det) at (6.6, -1.4) {\strut Detector};

    % ---------- SETAS ROW 1 ----------
    \draw[arw] (-1.1, 0) node[left, font=\scriptsize]{$g(t)$} -- (aa);
    \draw[arw] (aa)   -- (samp);
    \draw[arw] (samp) -- (q);
    \draw[arw] (q)    -- (enc);

    % ---------- CONECTOR SNAKE (enc → lc) ----------
    % Desce de enc, vai para a esquerda, sobe para lc
    \draw[arw, rounded corners=4pt]
      (enc.south) -- ++(0,-0.38) -| (lc.north);

    % ---------- SETAS ROW 2 ----------
    \draw[arw] (lc)  -- (ps);
    \draw[arw] (ps)  -- (ch);
    \draw[arw] (ch)  -- (det);
    \draw[arw] (det.east) -- ++(0.7,0)
               node[right, font=\scriptsize]{$\hat{a}_k$};

    % ---------- RÓTULOS DE CAPÍTULO ----------
    \node[grplbl, above=3pt] at (3.3, 0.34)  {Cap.~7: Conversão A/D};
    \node[grplbl, below=3pt] at (3.3, -1.74) {Cap.~6: Transmissão Digital};
  \end{tikzpicture}
  \end{center}%
}

% --- Cores adicionais para TikZ (cap6) ---
\definecolor{UNB_BLUE}{HTML}{003B5C}
\definecolor{UNB_GREEN}{HTML}{006633}
\definecolor{UNB_GOLD}{HTML}{F2A900}
\definecolor{RED}{HTML}{C0392B}
\definecolor{PURPLE}{HTML}{8E44AD}
\definecolor{TEAL}{HTML}{16A085}

% ============================================
% TAMANHOS PADRONIZADOS DE FIGURAS
% ============================================
\newcommand{\figFull}{0.85\textwidth}
\newcommand{\figHalf}{0.65\textwidth}
\newcommand{\figHalfV}{0.48\textwidth}
\newcommand{\figw}{\figFull}

% ============================================
% INÍCIO DO DOCUMENTO
% ============================================
\begin{document}

% ============================================
% SLIDE DE TÍTULO
% ============================================
\begin{frame}
\titlepage
\end{frame}

% ============================================
% SUMÁRIO
% ============================================
\begin{frame}{Sumário — Capítulo 7: Conversão A/D}
  \tableofcontents[sections={<1-3>},hideallsubsections]
\end{frame}

\begin{frame}{Sumário — Capítulo 6: Transmissão Digital}
  \tableofcontents[sections={<4-8>},hideallsubsections]
\end{frame}

% ============================================
% VISÃO GERAL: CADEIA COMPLETA
% ============================================
\begin{frame}{Visão Geral: Da Amostragem à Modulação}
  \begin{block}{Cadeia completa de processamento digital}
    \vspace{0.1cm}
    \drawpipeline{}
    \vspace{-0.1cm}
  \end{block}
  \vspace{0.15cm}
  {\footnotesize
  Estudaremos cada etapa desta cadeia:
  o \textbf{Cap.~7} cobre a conversão A/D (filtro anti-aliasing,
  amostragem, quantização e PCM);
  o \textbf{Cap.~6} cobre a transmissão digital em banda base
  (codificação de linha, formatação de pulso, diagrama de olho e PAM).}
\end{frame}

% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% SLIDE DE TRANSIÇÃO: CAPÍTULO 7
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
{
\setbeamercolor{background canvas}{bg=structure.fg}
\setbeamercolor{normal text}{fg=white}
\usebeamercolor[fg]{normal text}
\begin{frame}[plain,c]
\begin{center}
{\Huge\textbf{Capítulo 7}}\\[0.8cm]
{\LARGE Conversão Analógico-Digital}\\[0.5cm]
{\large Amostragem, Quantização, PCM e Companding}
\end{center}
\end{frame}
}

% ============================================
% CAPÍTULO 7: CONVERSÃO ANALÓGICO-DIGITAL
% ============================================
\input{cap7_analog_to_digital_conversion}

% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% SLIDE DE TRANSIÇÃO: CAPÍTULO 6
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
{
\setbeamercolor{background canvas}{bg=structure.fg}
\setbeamercolor{normal text}{fg=white}
\usebeamercolor[fg]{normal text}
\begin{frame}[plain,c]
\begin{center}
{\Huge\textbf{Capítulo 6}}\\[0.8cm]
{\LARGE Princípios de Transmissão Digital}\\[0.5cm]
{\large Codificação de Linha, Formatação de Pulso,\\
Diagrama de Olho e PAM M-ário}
\end{center}
\end{frame}
}

% ============================================
% CAPÍTULO 6: TRANSMISSÃO DIGITAL DE DADOS
% ============================================
\input{cap6_digital_data_transmission}

% ============================================
% AGRADECIMENTOS
% ============================================
\begin{frame}{Agradecimentos}
\begin{center}
\Large Obrigado pela atenção!

\vspace{1cm}

\normalsize
\textbf{Contato:}\\
\autorEmail

\vspace{0.5cm}

\textbf{\laboratorioFinal}\\
\universidadeFinal

\vspace{0.5cm}

\textbf{Dúvidas?}
\end{center}
\end{frame}

% ============================================
% REFERÊNCIAS
% ============================================
\begin{frame}[allowframebreaks]{Referências}
\nocite{*}
\bibliographystyle{ieeetr}
\bibliography{references}
\end{frame}

\end{document}
